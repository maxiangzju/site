---
import BaseLayout from '../../components/layout/BaseLayout.astro';
---

<BaseLayout title="Base64 Encoder/Decoder | Xiang's Island">
  <div class="max-w-5xl mx-auto px-4 py-16">
    <div class="mb-8">
      <a href="/tools" class="text-[var(--color-primary)] hover:underline mb-2 inline-block">← Back to Tools</a>
      <h1 class="text-3xl font-bold mb-2">Base64 Encoder / Decoder</h1>
      <p class="text-[var(--color-text-muted)]">
        Encode text to Base64 or decode Base64 strings.
      </p>
    </div>

    <div class="grid lg:grid-cols-2 gap-6">
      <div>
        <div class="flex items-center justify-between mb-3">
          <label for="input" class="text-lg font-semibold">Input</label>
          <button
            id="clearBtn"
            class="px-3 py-1 text-sm bg-[var(--color-bg-secondary)] border border-[var(--color-border)] rounded hover:border-[var(--color-primary)] transition-colors"
          >
            Clear
          </button>
        </div>
        <textarea
          id="input"
          placeholder="Enter text to encode or Base64 to decode"
          class="w-full h-[400px] p-4 bg-[var(--color-bg-secondary)] border border-[var(--color-border)] rounded-lg text-[var(--color-text)] font-mono text-sm resize-none focus:outline-none focus:border-[var(--color-primary)] transition-colors"
        ></textarea>
      </div>

      <div>
        <div class="flex items-center justify-between mb-3">
          <label for="output" class="text-lg font-semibold">Output</label>
          <button
            id="copyBtn"
            class="px-3 py-1 text-sm bg-[var(--color-bg-secondary)] border border-[var(--color-border)] rounded hover:border-[var(--color-primary)] transition-colors"
          >
            Copy
          </button>
        </div>
        <textarea
          id="output"
          readonly
          placeholder="Result will appear here..."
          class="w-full h-[400px] p-4 bg-[var(--color-bg-secondary)] border border-[var(--color-border)] rounded-lg text-[var(--color-text)] font-mono text-sm resize-none focus:outline-none"
        ></textarea>
      </div>
    </div>

    <div class="mt-6 flex flex-wrap gap-3">
      <button
        id="encodeBtn"
        class="px-6 py-2 bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary-dark)] transition-colors font-medium"
      >
        Encode
      </button>
      <button
        id="decodeBtn"
        class="px-6 py-2 bg-[var(--color-bg-secondary)] border border-[var(--color-border)] rounded-lg hover:border-[var(--color-primary)] transition-colors"
      >
        Decode
      </button>
    </div>

    <div id="statusMessage" class="mt-4 p-3 rounded-lg hidden"></div>

    <div class="mt-8 p-4 bg-[var(--color-bg-secondary)] border border-[var(--color-border)] rounded-lg">
      <h2 class="font-semibold mb-2">About Base64</h2>
      <p class="text-[var(--color-text-muted)] text-sm">
        Base64 encoding converts binary data into ASCII text format. It's commonly used for transmitting
        data over media that only support text content, such as email or embedding images in HTML/CSS.
      </p>
    </div>
  </div>
</BaseLayout>

<script>
  const input = document.getElementById('input') as HTMLTextAreaElement;
  const output = document.getElementById('output') as HTMLTextAreaElement;
  const encodeBtn = document.getElementById('encodeBtn') as HTMLButtonElement;
  const decodeBtn = document.getElementById('decodeBtn') as HTMLButtonElement;
  const clearBtn = document.getElementById('clearBtn') as HTMLButtonElement;
  const copyBtn = document.getElementById('copyBtn') as HTMLButtonElement;
  const statusMessage = document.getElementById('statusMessage') as HTMLDivElement;

  function showStatus(message: string, isError = false) {
    statusMessage.textContent = message;
    statusMessage.className = `mt-4 p-3 rounded-lg ${
      isError
        ? 'bg-red-900/30 border border-red-500/50 text-red-300'
        : 'bg-green-900/30 border border-green-500/50 text-green-300'
    }`;
    statusMessage.classList.remove('hidden');
    setTimeout(() => statusMessage.classList.add('hidden'), 3000);
  }

  encodeBtn.addEventListener('click', () => {
    try {
      const text = input.value;
      if (!text) {
        showStatus('Please enter text to encode', true);
        return;
      }
      output.value = btoa(text);
      showStatus('✓ Encoded successfully');
    } catch (e) {
      showStatus(`✗ Error: ${(e as Error).message}`, true);
    }
  });

  decodeBtn.addEventListener('click', () => {
    try {
      const text = input.value;
      if (!text) {
        showStatus('Please enter Base64 to decode', true);
        return;
      }
      output.value = atob(text);
      showStatus('✓ Decoded successfully');
    } catch (e) {
      showStatus('✗ Invalid Base64 string', true);
    }
  });

  clearBtn.addEventListener('click', () => {
    input.value = '';
    output.value = '';
  });

  copyBtn.addEventListener('click', async () => {
    if (output.value) {
      await navigator.clipboard.writeText(output.value);
      showStatus('✓ Copied to clipboard!');
    }
  });
</script>
